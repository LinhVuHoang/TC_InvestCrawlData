[2023-09-28T14:06:32.425+0700] {taskinstance.py:1157} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: crawl_dag_v01.run_my_async_task scheduled__2023-09-22T00:08:00+00:00 [queued]>
[2023-09-28T14:06:32.487+0700] {taskinstance.py:1157} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: crawl_dag_v01.run_my_async_task scheduled__2023-09-22T00:08:00+00:00 [queued]>
[2023-09-28T14:06:32.488+0700] {taskinstance.py:1359} INFO - Starting attempt 1 of 6
[2023-09-28T14:06:32.509+0700] {taskinstance.py:1380} INFO - Executing <Task(PythonOperator): run_my_async_task> on 2023-09-22 00:08:00+00:00
[2023-09-28T14:06:32.521+0700] {standard_task_runner.py:57} INFO - Started process 384 to run task
[2023-09-28T14:06:32.563+0700] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'crawl_dag_v01', 'run_my_async_task', 'scheduled__2023-09-22T00:08:00+00:00', '--job-id', '39', '--raw', '--subdir', 'DAGS_FOLDER/crawlInvest.py', '--cfg-path', '/tmp/tmpwsjl6dag']
[2023-09-28T14:06:32.566+0700] {standard_task_runner.py:85} INFO - Job 39: Subtask run_my_async_task
[2023-09-28T14:06:32.785+0700] {task_command.py:415} INFO - Running <TaskInstance: crawl_dag_v01.run_my_async_task scheduled__2023-09-22T00:08:00+00:00 [running]> on host 052a1d3faae2
[2023-09-28T14:06:32.948+0700] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='linhhv' AIRFLOW_CTX_DAG_ID='crawl_dag_v01' AIRFLOW_CTX_TASK_ID='run_my_async_task' AIRFLOW_CTX_EXECUTION_DATE='2023-09-22T00:08:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-09-22T00:08:00+00:00'
[2023-09-28T14:06:32.966+0700] {logging_mixin.py:151} INFO - ['ASG', 'BAX', 'BCF', 'BSA', 'BSH', 'DHB', 'DP2', 'DSG', 'DTK', 'EIC', 'GTS', 'HRC', 'HSA', 'HSM', 'IFS', 'ISH', 'MKP', 'MVB', 'NAW', 'PDN', 'PJC', 'PNP', 'PVX', 'SAF', 'SC5', 'SGH', 'SJG', 'SQC', 'SZE', 'TTL', 'TVC', 'VCF', 'VRG', 'VSI', 'VSN', 'WCS', 'XDH', 'YBC', 'APC', 'AME', 'BSP', 'BSQ', 'BTW', 'CCR', 'CDP', 'CMD', 'CMF', 'CTW', 'DFF', 'DP1', 'DWS', 'HC3', 'HJS', 'HNA', 'HNF', 'HTL', 'LM8', 'MDF', 'MH3', 'MVN', 'NCS', 'NTH', 'PAC', 'PGI', 'PTI', 'SGI', 'SID', 'SLS', 'SRC', 'SWC', 'TBD', 'TPC', 'TV3', 'TYA', 'VFC', 'VFG', 'VGR', 'VIT', 'VNC', 'XHC', 'EMS', 'HUG', 'IST', 'NBW', 'PCT', 'SSC', 'TIX', 'AST', 'FOC', 'LIX', 'NET', 'SBL', 'VDP', 'VNF', 'HWS', 'MAS', 'NST', 'SMA', 'YBM', 'BWS', 'CBI', 'HTI', 'RDP', 'VMC', 'VPS', 'CCI', 'CLC', 'GMC', 'HBC', 'HVN', 'POT', 'TVB', 'ADG', 'DRG', 'MML', 'NSC', 'PGD', 'PGS', 'POS', 'TDP', 'UIC', 'SZB', 'VET', 'PSP', 'VHL', 'ABT', 'CDN', 'EID', 'FCS', 'HVT', 'RTB', 'SEA', 'SHP', 'SMB', 'VCR', 'VIN', 'AGP', 'CAV', 'PDV', 'PMC', 'SAS', 'TDM', 'VMD', 'PRT', 'SJE', 'TCT', 'V21', 'VBB', 'BSG', 'TRA', 'VNA', 'GSM', 'SHN', 'VCB', 'APF', 'CAG', 'CIA', 'CLH', 'CMV', 'DRL', 'DTL', 'FIC', 'HMC', 'HRT', 'HTV', 'ICT', 'INN', 'KSV', 'LEC', 'NTT', 'OPC', 'PCG', 'PGB', 'SAV', 'SRT', 'SZL', 'TLP', 'TMS', 'TRC', 'TTT', 'VAF', 'VEF', 'VIF', 'VPD', 'BHN', 'CNT', 'HND', 'HTG', 'MTA', 'SFI', 'SJS', 'TV1', 'AAA', 'AAS', 'AAT', 'AAV', 'ABB', 'ABC', 'ABI', 'ABS', 'ACB', 'ACC', 'ACG', 'ACL', 'ACV', 'ADS', 'AFX', 'AGG', 'AGR', 'AMS', 'AMV', 'ANV', 'APG', 'APH', 'API', 'APS', 'ASM', 'ASP', 'BAB', 'BAF', 'BCC', 'BCE', 'BCG', 'BCM', 'BDG', 'BDT', 'BFC', 'BIC', 'BID', 'BKG', 'BMC', 'BMI', 'BMP', 'BMS', 'BNA', 'BOT', 'BSI', 'BSR', 'BTP', 'BTS', 'BVB', 'BVH', 'BVS', 'BWE', 'C32', 'C47', 'C4G', 'CAP', 'CC1', 'CCL', 'CDC', 'CEO', 'CHP', 'CII', 'CKG', 'CLL', 'CLX', 'CMG', 'CMX', 'CNG', 'CRC', 'CRE', 'CSC', 'CSI', 'CSM', 'CSV', 'CTD', 'CTF', 'CTG', 'CTI', 'CTR', 'CTS', 'D2D', 'DAG', 'DAH', 'DAT', 'DBC', 'DBD', 'DCL', 'DCM', 'DDG', 'DDV', 'DGC', 'DGT', 'DGW', 'DHA', 'DHC', 'DHG', 'DHT', 'DIG', 'DIH', 'DL1', 'DLG', 'DMC', 'DNP', 'DP3', 'DPG', 'DPM', 'DPR', 'DQC', 'DRC', 'DRH', 'DRI', 'DSC', 'DSN', 'DTD', 'DTI', 'DVN', 'DVP', 'DXG', 'DXP', 'DXS', 'EIB', 'ELC', 'EVE', 'EVF', 'EVG', 'EVS', 'FCM', 'FCN', 'FIR', 'FIT', 'FMC', 'FOX', 'FPT', 'FRT', 'FTS', 'G36', 'GAS', 'GDT', 'GEG', 'GEX', 'GHC', 'GIL', 'GKM', 'GMD', 'GSP', 'GVR', 'HAG', 'HAH', 'HAN', 'HAP', 'HAR', 'HAX', 'HCM', 'HDB', 'HDC', 'HDG', 'HEM', 'HHS', 'HHV', 'HII', 'HLD', 'HNG', 'HOM', 'HPG', 'HQC', 'HSG', 'HT1', 'HTN', 'HTP', 'HUB', 'HUT', 'HVH', 'ICG', 'ICN', 'IDC', 'IDI', 'IDJ', 'IDV', 'IJC', 'ILB', 'ILS', 'IMP', 'IPA', 'ITA', 'ITC', 'ITD', 'IVS', 'JVC', 'KBC', 'KDC', 'KDH', 'KGM', 'KHG', 'KHP', 'KLB', 'KMR', 'KOS', 'KPF', 'KSB', 'KSF', 'L14', 'L18', 'L61', 'LAS', 'LBM', 'LCG', 'LDG', 'LDP', 'LGL', 'LHC', 'LHG', 'LIC', 'LIG', 'LMH', 'LPB', 'LSS', 'LTG', 'M10', 'MBB', 'MBG', 'MBS', 'MCH', 'MCM', 'MIG', 'MPC', 'MSB', 'MSH', 'MSN', 'MSR', 'MST', 'MVC', 'MWG', 'NAB', 'NAF', 'NBB', 'NBC', 'NCT', 'NDN', 'NED', 'NHA', 'NHH', 'NHT', 'NKG', 'NLG', 'NNC', 'NRC', 'NT2', 'NTC', 'NTL', 'NTP', 'NVB', 'NVL', 'NVT', 'OCB', 'OCH', 'OGC', 'OIL', 'ORS', 'PAN', 'PAS', 'PBC', 'PC1', 'PDR', 'PET', 'PGC', 'PGV', 'PHC', 'PHP', 'PHR', 'PLC', 'PLP', 'PLX', 'PNJ', 'POM', 'POW', 'PPC', 'PPH', 'PSD', 'PSH', 'PSI', 'PTB', 'PTL', 'PVB', 'PVC', 'PVD', 'PVG', 'PVI', 'PVM', 'PVP', 'PVS', 'PVT', 'PXL', 'PXS', 'QBS', 'QCG', 'QNS', 'QTP', 'RAL', 'REE', 'RGC', 'RIC', 'S99', 'SAB', 'SAM', 'SBA', 'SBS', 'SBT', 'SBV', 'SCD', 'SCG', 'SCI', 'SCR', 'SCS', 'SD9', 'SFG', 'SGB', 'SGN', 'SGP', 'SGR', 'SGT', 'SHB', 'SHI', 'SHS', 'SIP', 'SJD', 'SJF', 'SKG', 'SKH', 'SKV', 'SMC', 'SNZ', 'SRA', 'SSB', 'SSH', 'SSI', 'ST8', 'STB', 'STK', 'SZC', 'TAR', 'TCB', 'TCD', 'TCH', 'TCI', 'TCL', 'TCM', 'TCO', 'TCW', 'TDC', 'TDH', 'TEG', 'THD', 'THG', 'THT', 'TID', 'TIG', 'TIP', 'TIS', 'TLG', 'TLH', 'TMT', 'TN1', 'TNA', 'TNG', 'TNH', 'TNI', 'TNT', 'TOS', 'TPB', 'TSC', 'TTA', 'TTF', 'TTN', 'TV2', 'TV4', 'TVD', 'TVN', 'TVS', 'TVT', 'VC2', 'VC3', 'VC7', 'VCG', 'VCI', 'VCS', 'VDS', 'VEA', 'VEC', 'VFS', 'VGC', 'VGG', 'VGI', 'VGS', 'VGT', 'VGV', 'VHC', 'VHE', 'VHM', 'VIB', 'VIC', 'VIP', 'VIX', 'VJC', 'VLB', 'VLC', 'VNB', 'VND', 'VNE', 'VNG', 'VNM', 'VNR', 'VNS', 'VOC', 'VOS', 'VPB', 'VPG', 'VPH', 'VPI', 'VRC', 'VRE', 'VSA', 'VSC', 'VSF', 'VSH', 'VTO', 'VTP', 'VTR', 'VTV', 'WSS', 'XMC', 'YEG']
[2023-09-28T14:06:32.968+0700] {logging_mixin.py:151} INFO - etl_ingest_time_2023_09_28_14_06_32
[2023-09-28T14:06:33.023+0700] {taskinstance.py:1935} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 192, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 209, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/crawlInvest.py", line 161, in run_my_async_task
    asyncio.run(crawl(Code_stock))
  File "/usr/local/lib/python3.8/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "/usr/local/lib/python3.8/asyncio/base_events.py", line 616, in run_until_complete
    return future.result()
  File "/opt/airflow/dags/crawlInvest.py", line 97, in crawl
    cursor.execute(query_db)
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Database 'etl_ingest_time_2023_09_28_14_06_32' already exists. Choose a different database name. (1801) (SQLExecDirectW)")
[2023-09-28T14:06:33.039+0700] {taskinstance.py:1398} INFO - Marking task as UP_FOR_RETRY. dag_id=crawl_dag_v01, task_id=run_my_async_task, execution_date=20230922T000800, start_date=20230928T070632, end_date=20230928T070633
[2023-09-28T14:06:33.054+0700] {standard_task_runner.py:104} ERROR - Failed to execute job 39 for task run_my_async_task (('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Database 'etl_ingest_time_2023_09_28_14_06_32' already exists. Choose a different database name. (1801) (SQLExecDirectW)"); 384)
[2023-09-28T14:06:33.090+0700] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2023-09-28T14:06:33.121+0700] {taskinstance.py:2776} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-09-28T14:11:47.011+0700] {taskinstance.py:1157} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: crawl_dag_v01.run_my_async_task scheduled__2023-09-22T00:08:00+00:00 [queued]>
[2023-09-28T14:11:47.051+0700] {taskinstance.py:1157} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: crawl_dag_v01.run_my_async_task scheduled__2023-09-22T00:08:00+00:00 [queued]>
[2023-09-28T14:11:47.052+0700] {taskinstance.py:1359} INFO - Starting attempt 1 of 6
[2023-09-28T14:11:47.096+0700] {taskinstance.py:1380} INFO - Executing <Task(PythonOperator): run_my_async_task> on 2023-09-22 00:08:00+00:00
[2023-09-28T14:11:47.117+0700] {standard_task_runner.py:57} INFO - Started process 797 to run task
[2023-09-28T14:11:47.124+0700] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'crawl_dag_v01', 'run_my_async_task', 'scheduled__2023-09-22T00:08:00+00:00', '--job-id', '72', '--raw', '--subdir', 'DAGS_FOLDER/crawlInvest.py', '--cfg-path', '/tmp/tmp4vw4qk05']
[2023-09-28T14:11:47.134+0700] {standard_task_runner.py:85} INFO - Job 72: Subtask run_my_async_task
[2023-09-28T14:11:47.240+0700] {task_command.py:415} INFO - Running <TaskInstance: crawl_dag_v01.run_my_async_task scheduled__2023-09-22T00:08:00+00:00 [running]> on host 052a1d3faae2
[2023-09-28T14:11:47.356+0700] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='linhhv' AIRFLOW_CTX_DAG_ID='crawl_dag_v01' AIRFLOW_CTX_TASK_ID='run_my_async_task' AIRFLOW_CTX_EXECUTION_DATE='2023-09-22T00:08:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-09-22T00:08:00+00:00'
[2023-09-28T14:11:47.372+0700] {logging_mixin.py:151} INFO - ['ASG', 'BAX', 'BCF', 'BSA', 'BSH', 'DHB', 'DP2', 'DSG', 'DTK', 'EIC']
[2023-09-28T14:11:47.374+0700] {logging_mixin.py:151} INFO - etl_ingest_time_2023_09_28_14_11_47
[2023-09-28T14:11:48.234+0700] {logging_mixin.py:151} INFO - 10
[2023-09-28T14:11:48.235+0700] {logging_mixin.py:151} INFO - 1
[2023-09-28T14:11:48.241+0700] {logging_mixin.py:151} WARNING -   0%|          | 0/1 [00:00<?, ?it/s]
[2023-09-28T14:11:48.242+0700] {logging_mixin.py:151} INFO - ['ASG', 'BAX', 'BCF', 'BSA', 'BSH', 'DHB', 'DP2', 'DSG', 'DTK', 'EIC']
[2023-09-28T14:11:49.118+0700] {logging_mixin.py:151} INFO - [Empty DataFrame
Columns: []
Index: [],          p    v      cp  rcp   a   ba     sa     hl  pcp         t
0  50200.0  100 -4600.0 -0.1  SD  0.0  100.0  False  0.0  09:00:13, Empty DataFrame
Columns: []
Index: [], Empty DataFrame
Columns: []
Index: [], Empty DataFrame
Columns: []
Index: [], Empty DataFrame
Columns: []
Index: [], Empty DataFrame
Columns: []
Index: [], Empty DataFrame
Columns: []
Index: [],          p    v     cp  rcp   a     ba     sa     hl    pcp         t
0  10700.0  200    0.0  0.0  BU  400.0  100.0  False    0.0  14:03:06
1  10700.0  100    0.0  0.0  BU  200.0  100.0  False    0.0  13:35:59
2  10700.0  100    0.0  0.0  SD  100.0  100.0  False -200.0  10:40:12
3  10900.0  100  200.0  0.0  BU  100.0    0.0  False    0.0  09:57:39, Empty DataFrame
Columns: []
Index: []]
[2023-09-28T14:11:49.177+0700] {logging_mixin.py:151} INFO - hello
[2023-09-28T14:11:49.178+0700] {logging_mixin.py:151} INFO - 10
[2023-09-28T14:11:49.183+0700] {logging_mixin.py:151} WARNING -   0%|          | 0/10 [00:00<?, ?it/s]
[2023-09-28T14:11:49.184+0700] {logging_mixin.py:151} WARNING - 
[2023-09-28T14:11:49.186+0700] {logging_mixin.py:151} INFO - ASG is empty
[2023-09-28T14:11:49.308+0700] {logging_mixin.py:151} INFO -          p    v      cp  rcp   a   ba     sa     hl  pcp         t
0  50200.0  100 -4600.0 -0.1  SD  0.0  100.0  False  0.0  09:00:13
[2023-09-28T14:11:49.374+0700] {logging_mixin.py:151} INFO - DRIVER={ODBC Driver 18 for SQL Server};SERVER=host.docker.internal;DATABASE=etl_ingest_time_2023_09_28_14_11_47;UID=sa;PWD=Docker@123;TrustServerCertificate=yes;
[2023-09-28T14:11:51.576+0700] {base.py:73} INFO - Using connection ID 'minio_s3_conn' for task execution.
[2023-09-28T14:11:51.577+0700] {connection_wrapper.py:340} INFO - AWS Connection (conn_id='minio_s3_conn', conn_type='aws') credentials retrieved from login and password.
[2023-09-28T14:11:51.839+0700] {logging_mixin.py:151} WARNING -  20%|##        | 2/10 [00:02<00:10,  1.33s/it]
[2023-09-28T14:11:51.840+0700] {logging_mixin.py:151} WARNING - 
[2023-09-28T14:11:51.840+0700] {logging_mixin.py:151} INFO - BCF is empty
[2023-09-28T14:11:51.841+0700] {logging_mixin.py:151} INFO - BSA is empty
[2023-09-28T14:11:51.841+0700] {logging_mixin.py:151} INFO - BSH is empty
[2023-09-28T14:11:51.841+0700] {logging_mixin.py:151} INFO - DHB is empty
[2023-09-28T14:11:51.842+0700] {logging_mixin.py:151} INFO - DP2 is empty
[2023-09-28T14:11:51.842+0700] {logging_mixin.py:151} INFO - DSG is empty
[2023-09-28T14:11:51.848+0700] {logging_mixin.py:151} INFO -          p    v     cp  rcp   a     ba     sa     hl    pcp         t
0  10700.0  200    0.0  0.0  BU  400.0  100.0  False    0.0  14:03:06
1  10700.0  100    0.0  0.0  BU  200.0  100.0  False    0.0  13:35:59
2  10700.0  100    0.0  0.0  SD  100.0  100.0  False -200.0  10:40:12
3  10900.0  100  200.0  0.0  BU  100.0    0.0  False    0.0  09:57:39
[2023-09-28T14:11:51.855+0700] {logging_mixin.py:151} INFO - DRIVER={ODBC Driver 18 for SQL Server};SERVER=host.docker.internal;DATABASE=etl_ingest_time_2023_09_28_14_11_47;UID=sa;PWD=Docker@123;TrustServerCertificate=yes;
[2023-09-28T14:11:51.968+0700] {base.py:73} INFO - Using connection ID 'minio_s3_conn' for task execution.
[2023-09-28T14:11:51.969+0700] {connection_wrapper.py:340} INFO - AWS Connection (conn_id='minio_s3_conn', conn_type='aws') credentials retrieved from login and password.
[2023-09-28T14:11:52.046+0700] {logging_mixin.py:151} WARNING -  90%|######### | 9/10 [00:02<00:00,  4.07it/s]
[2023-09-28T14:11:52.047+0700] {logging_mixin.py:151} WARNING - 
[2023-09-28T14:11:52.047+0700] {logging_mixin.py:151} INFO - EIC is empty
[2023-09-28T14:11:52.048+0700] {logging_mixin.py:151} WARNING - 100%|##########| 10/10 [00:02<00:00,  3.49it/s]
[2023-09-28T14:11:52.048+0700] {logging_mixin.py:151} INFO - chay lan 1
[2023-09-28T14:11:52.049+0700] {logging_mixin.py:151} INFO - Took 3.81 s
[2023-09-28T14:11:52.049+0700] {logging_mixin.py:151} WARNING - 100%|##########| 1/1 [00:03<00:00,  3.81s/it]
[2023-09-28T14:11:52.050+0700] {logging_mixin.py:151} WARNING - 100%|##########| 1/1 [00:03<00:00,  3.81s/it]
[2023-09-28T14:11:52.050+0700] {logging_mixin.py:151} INFO - DONE CRAWL IN 3.82 s
[2023-09-28T14:11:52.052+0700] {python.py:194} INFO - Done. Returned value was: None
[2023-09-28T14:11:52.062+0700] {taskinstance.py:1398} INFO - Marking task as SUCCESS. dag_id=crawl_dag_v01, task_id=run_my_async_task, execution_date=20230922T000800, start_date=20230928T071147, end_date=20230928T071152
[2023-09-28T14:11:52.090+0700] {local_task_job_runner.py:228} INFO - Task exited with return code 0
[2023-09-28T14:11:52.107+0700] {taskinstance.py:2776} INFO - 0 downstream tasks scheduled from follow-on schedule check
